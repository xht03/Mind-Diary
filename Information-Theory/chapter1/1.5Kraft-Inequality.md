---
title: Chapter 1: Source coding (5)
date: 2025-03-05 14:18:20
tags:
- translation
- notes
categories:
- Information and Coding Theory
---

## 1.5 Kraft's Inequality

受到 §1.4 中示例的启发，我们得到以下结论，被称为 **Kraft 不等式**（Kraft's inequality）：  

> **定理 1.20（Kraft's Inequality）**  
> 对于一个 **$ r $-进制即时码**（instantaneous $ r $-ary code）$ C $，其码字长度为 $ l_1, l_2, \dots, l_q $，则该码能够存在的**充要条件**是：
>
> $$
> \sum_{i=1}^{q} r^{-l_i} \leq 1
> $$

**证明**
(<=) 我们可以对码字长度重新编号，使其满足以下顺序：$ l_1 \leq l_2 \leq \dots \leq l_q $。设$ l = \max(l_1, \dots, l_q) $，并考虑树 $ T^* $ 的一部分 $ T^{\le l} $，定义为：$ T^{\le l} = T^0 \cup T^1 \cup \dots \cup T^l $，即从根到最大高度为 $ l $ 的所有节点组成的部分。显然，该树是一个**有限树**（finite tree）：  

- 在每个高度 $ h = 0,1, \dots, l $ 处，树具有 $ r^h $ 个顶点（即**长度为 $ h $ 的所有可能单词**）。  

- *叶子节点是高度为 $ l $ 的所有 $ r^l $ 个顶点。  

我们可以为符号 $ s_1 $ **分配**一个**高度为** $ l_1 $ **的顶点** $ w_1 $，其长度为 $ l_i $。接着，我们**修剪**$ w_i $ 及其上方的整个子树 $ T^{\le l} $，因为这些顶点不能再被使用。特别地，这一操作会移除 $ r^{l - l_1} $ 个叶子节点，即所有以 $ w_i $ 开头的长度为 $ l $ 的单词（参见图 1.3）。  

![](https://ref.xht03.online/202503051443951.png)

如果 $ q > 1 $， $ r^{l-l_1} < r^l $ ，因此，在第一次修剪后，$ T^{\le l} $ 至少有一个叶子节点未被修剪。我们截取该叶子节点的前 $ l_2 $ 个符号构造出第二个码字 $ w_2 $，其长度为 $ l_2 $。由于该节点不在 $ w_1 $ 之上，我们可以选择它作为新的码字。接着，我们修剪 $ w_2 $ 及其上方的整个子树 $ T^{\le l} $，这样会进一步移除 $ r^{l - l_2} $ 个叶子节点。由于没有叶子节点既位于 $ w_1 $ 之上又位于 $ w_2 $ 之上，因此两次修剪不会发生重叠。  

我们如此循环往复，每次选择一个码字并修剪，使得**没有任何一个码字在另一个码字的上方或下方**。当已选择了 $ k $ 个码字 $ w_1, w_2, \dots, w_k $ （其中 $ k < q $）时，我们已经修剪了总计 $ r^{l - l_1} + r^{l - l_2} + \dots - r^{l - l_k} $ 个叶子节点。
 
由于

$$
\sum_{i=1}^{k} r^{l - l_i} < \sum_{i=1}^{q} r^{l - l_i} \le r^l
$$

所以，第k次修剪之后，至少还有一个叶子节点剩余，因此我们可以从该叶子节点的前 $ l_{k+1} $ 个符号构造出新的码字 $ w_{k+1} $，其长度为 $ l_{k+1} $。按照这个方法，我们可以不断地选择新的码字，直到选择出 $ w_q $ 为止。  

在整个过程中，前缀条件（prefix condition）始终成立，因此根据**定理 1.17**，最终构造出的编码集 $ C = \{ w_1, w_2, \dots, w_q \} $ 是一个**瞬时码**（instantaneous code）。

(=>) 如果 $ C $ 是瞬时码，那么根据**定理 1.17**，它必须是前缀码（prefix code）。因此，树 $ T^{\le l} $ 的每个叶子节点至多位于一个码字的**上方**。  

对于 $ C $ 中的每个码字 $ w_i $，位于 $ r^{l - l_i} $ 个叶子节点的下方（其中 $ l_i = |w_i| $）。对所有码字 $ w_i $ 求和，我们得到：$ \sum_{i=1}^{q} r^{l - l_i} $ ，表示所有码字**上方的叶子总数**。由于树 $ T^*_l $ 总共有 $ r^l $ 个叶子节点，因此必须满足：  

$$
\sum_{i=1}^{q} r^{l - l_i} \leq r^l
$$  

两边同时除以 $ r^l $，我们得到 Kraft 不等式：$ \sum_{i=1}^{q} r^{-l_i} \leq 1 $。



