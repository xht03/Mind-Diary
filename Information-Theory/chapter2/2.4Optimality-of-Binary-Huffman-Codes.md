---
title: "Chapter 2: Optimal Codes (4)"
author: "xht03"
date: 2025-03-17 15:52:30
tags:
- translation
- notes
categories:
- Information and Coding Theory
header-includes:
- \usepackage{xeCJK}
---

## 2.4 Optimality of Binary Huffman Codes

在本节中，我们将证明**二进制 Huffman 编码是最优的** 。首先，我们需要一个定义和一个引理。

> **定义 2.6**
> 如果两个二进制单词 $w_1$ 和 $w_2$ 具有形式 $x0$ 和 $x1$ （或反之），其中 $x \in T^*$ ，则称它们为**兄弟（siblings）** 。

> **引理 2.7**
> 对于任何源 $S$ ，都存在一个最优二进制编码 $V$ ，且其中**两个最长的编码单词是兄弟** 。

**证明**
根据定理 2.3，$S$ 存在一个最优二进制编码。在所有这样的编码中，选择一个 $D$ 使得：$\sigma(D) = \sum l_i$ 最小，其中 $\sigma(D)$ 是所有编码单词的长度总和（由于长度是非负整数，这样的 $D$ 是存在的）。 我们断言 $D$ 具有所需的性质。

1. 选择 $D$ 中最长的编码单词，设其形式为 $xt$ ，其中 $x \in T^*$ ，$t \in T = Z_2$ 。

2. 令 $\bar{t} = 1 - t$ ，即如果 $t = 1$ ，则 $\bar{t} = 0$ ，反之亦然。 

3. 如果 $x\bar{t} \in D$ ，那么 $xt$ 和 $x\bar{t}$ 就是所需的兄弟单词，证明完成。

4. 假设 $x\bar{t} \notin D$ 。由于 $D$ 是**前缀码**，那么 $D$ 中前缀为 $x$ 的唯一编码单词是 $xt$ （因为 $|xt|$ 是最长的，并且 $x\bar{t} \notin V$ ）。

5. 现在用 $x$ 取代 $xt$ 得到新的编码 $D'$ ，由于 $D'$ 仍然是前缀码，所以它也是一个**瞬时码**。

6. 但是，$V'$ 的长度总和：
   $$
   \sigma(D') = \sigma(D) - 1 < \sigma(D)
   $$
   这与我们对 $D$ 的选择相矛盾（因为 $D$ 是使 $\sigma(D)$ 最小的最优编码）。  

因此，$x\bar{t} \in V$，即 $xt$ 和 $x\bar{t}$ 必然存在于 $V$ 中，它们是兄弟单词，证明完毕。

---

> **定理 2.8**  
> 如果 $C$ 是源 $S$ 的二进制 Huffman 码，则 $C$ 是 $S$ 的最优码。

**证明**
引理 2.4 表明 $C$ 是瞬时码，因此只需要证明 $L(C)$ 是最小的（在所有源 $ S $ 的瞬时二进制码的平均字长中）。我们通过对源符号数 $q$ 使用数学归纳法来证明。

- 如果 $q = 1$ ，则 $C = \{\epsilon\}$，且 $L(C) = 0$ ，因此结论显然成立。

- 因此我们可以假设 $ q > 1 $ ，并且假设对于所有具有 $ q - 1 $ 个符号的源，结论已经证明。

设 $S'$ 是通过在 §2.2 中所述的方式对 $S$ 进行简化得到的源，所以 $S'$ 具有 $q-1$ 个符号 $s_1, \ldots, s_{q-2}, s' = s_{q-1} \cup s_q$ 。根据 §2.3 公式，我们有：$L(C) - L(C') = p_{q-1} + p_q = p'$ ，其中 $p'$ 是 $s'$ 的概率。

现在设 $D: s_i \to x_i$ 为由引理 2.7 给出的 $S$ 的最优二进制码，其中 $D$ 具有一对最长的兄弟码字 $x_u = x0$ 和 $x_v = x1$ ，表示源 $S$ 的符号 $s_u$ 和 $s_v$ 。我们将证明可以假设 $u = q-1$ 和 $v = q$ 。

如果 $v \neq q$，则我们可以交换分配给 $s_v$ 和 $s_q$ 的码字 $x_v$ 和 $x_q$ ，得到另一个源 $S$ 的瞬时码 $D^*$ 。如果 $m_i$ 表示码字 $x_i$ 的长度，则该交换将替换 $p_v m_v + p_q m_q$ 在 $ L(D) $ 中的项，改为 $p_v m_q + p_q m_v$ 在 $ L(D^*) $ 中的项。现在：

$$
(p_v m_v + p_q m_q) - (p_v m_q + p_q m_v) = (p_v - p_q)(m_v - m_q) \geq 0
$$

这是因为 $p_v \geq p_q$ 且 $m_v \geq m_q$ ，因此 $L(D) \geq L(D^*)$ 。由于 $D$ 是最优的，这意味着 $L(D) = L(D^*)$ ，并且 $D^*$ 也是最优的。因此，我们可以在必要时将 $ D $ 替换为 $ D^* $ ，从而假设 $v = q$ 。类似的论证使得我们可以假设 $u = q - 1$ ，因此 $D$ 中的兄弟码字 $x0$ 和 $x1$ 是 $ s_{q-1} $ 和 $ s_q $ 的码字。

接下来我们为 $S'$ 形成一个码 $D'$ ，其中 $s_i \to x_i$ 对于 $i = 1, \ldots, q-2$ ，并且 $s' \to x$ 。因此，$D$ 与 $D'$ 的关系与 $C$ 与 $C'$ 的关系相同。特别地，应用 §2.3 中的论证，得到：

$$
L(D) - L(D') = p_{q-1} + p_q = L(C) - L(C')
$$

因此，

$$
L(D') - L(C') = L(D) - L(C)
$$

现在，$C'$ 是 $S'$ 的一个 Huffman 码，$S'$ 是一个具有 $q-1$ 个符号的源，因此根据归纳假设，$C'$ 是最优的；因此，$L(C') \leq L(D')$ ，从而有 $L(C) \leq L(D)$ 。由于 $D$ 是最优的，$C$ 也是最优的（且 $L(C) = L(V)$ ）。

