---
title: "Chapter 2: Optimal Codes (5)"
author: "xht03"
date: 2025-03-17 17:52:30
tags:
- translation
- notes
categories:
- Information and Coding Theory
header-includes:
- \usepackage{xeCJK}
---

## 2.5 r-ary Huffman Codes

如果我们使用一个字母表 $T$ ，且其大小 $|T| = r > 2$ ，那么构建 $r$ 进制 Huffman 码的方法与二进制情况类似。给定一个源 $S$，我们依次形成一系列简化后的源 $S', S'', \dots$ ，每次将 $r$ 个最不可能的符号 $s_i$ 合并成一个符号 $s'$ ，并将它们的概率相加得到 $s'$ 的概率 $p'$ 。

最终我们希望将源 $S$ 简化为一个只有一个符号（概率为1）的源，并为该符号分配码字 $\epsilon$ 。由于每一步简化过程都会减少 $r - 1$ 个符号，因此只有当 $q \equiv 1 \mod (r - 1)$ 时，简化过程才是可能的。当 $r = 2$ 时，这个条件始终满足，但当 $r > 2$ 时不一定满足。如果 $q \not\equiv 1 \mod (r - 1)$，我们可以向 $S$ 中添加足够多的符号 $S_i$，其概率 $p_i = 0$，通过增加 $q$ 来使得这个同余条件成立，然后继续进行简化过程。

> **例 2.9**
> 设 $q = 6$ 和 $r = 3$ 。由于 $r - 1 = 2$ ，我们需要 $q \equiv 1 \mod (2)$ ，因此我们向 $S$ 中附加一个额外的符号 $s_7$ ，其概率 $p_7 = 0$ 。然后，简化过程产生了源 $S'$ , $S''$ 和 $S'''$ ，它们的符号数量分别为 5、3 和 1。

构造码 $C$ 的过程与二进制情况类似。给定源 $S^{(i)}$ 的码 $C^{(i)}$ ，我们为源 $S^{(i-1)}$ 构造码 $C^{(i-1)}$ ：这是通过移除新符号 $s'$ 的码字 $w'$，并用 $S^{(i-1)}$ 中合并成 $s'$ 的 $r$ 个符号的码字 $w't$（ $t \in T$ ）替换它。通过迭代这一过程，我们最终得到源 $S$ 的 $r$ 进制 Huffman 码 $C$ ，并删除开始时附加的任何额外符号 $s_i$ 的码字。

> **例 2.10**
> 设 $q = 6$ 和 $r = 3$ ，如同在例 2.9 中所述，并且假设源 $S$ 的符号 $s_1, \dots, s_6$ 的概率为 $p_1 = 0.3, p_2 = 0.2, p_3 = 0.2, p_4 = 0.1, p_5 = 0.1, p_6 = 0.1$ 。在附加了 $s_7$ 并使其概率 $p_7 = 0$ 后，简化过程如下：
>
> 以下是将给定的概率分布整理成表格的形式：
>
> |           |       |         |     |      |      |         |      |       |      |     |
> |-----------|-------|---------|-----|------|------|---------|------|-------|------|-----|
> | $S$       |       |         | 0.3 | 0.2  |  0.2 |         |  0.1 |  0.1  |  0.1 |  0  |
> | $S'$      |       |         | 0.3 | 0.2  |  0.2 | **0.2** |  0.1 |       |      |     |
> | $S''$     |       | **0.5** | 0.3 | 0.2  |      |         |      |       |      |     |
> | $S'''$    | **1** |         |     |      |      |         |      |       |      |     |
>
> 如果我们取 $T = \mathbb{Z}_3 = \{0, 1, 2\}$ ，那么一种可能的编码过程是：
>
> |           |            |         |     |      |      |         |      |       |      |     |
> |-----------|------------|---------|-----|------|------|---------|------|-------|------|-----|
> | $C$       |            |         | 1   | 2    |  00  |         |  02  |  010  |  011 | 012 |
> | $C'$      |            |         | 1   | 2    |  00  | **01**  |  02  |       |      |     |
> | $C''$     |            |  **0**  | 1   | 2    |      |         |      |       |      |     |
> | $C'''$    | $\epsilon$ |         |     |      |      |         |      |       |      |     |
>
> 删除附加符号 $s_7$ 的码字 $012$ 后，我们得到源 $S$ 的三进制 Huffman 码：$C = \{ 1, 2, 00, 02, 010, 011 \}$ ，且平均码长为 $L(C) = 1.7$ 。